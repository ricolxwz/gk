---
title: 数据库:应用开发
comments: true
---

## 交互式和非交互式SQL

交互式SQL, 用户通过命令行或者图形几面的SQL客户端与数据库进行交互, 实时输入SQL语句并获取结果. 用户可以逐条执行SQL命令, 比立即看到执行结果, 交互式SQL主要用于用于数据库的管理, 调试, 数据查询或者临时操作.

非交互式SQL, SQL语句以脚本或者嵌入的方式提交给数据库执行, 通常不需要用户的实时参与. 非交互式SQL可以通过编程语言的数据库库调用, 如Python的pymysql, Java的JDBC等, 或者通过预先写好的SQL脚本. SQL命令被预先定义好并批量执行.

## 架构

### 单层架构

单层架构, 或称集中式系统, Centralized System, 通常指的是客户端, 应用程序逻辑和数据库管理系统全都集成在一个应用程序中. 这种架构通常适用于有一个集成数据库的应用, 如MS Access或者SQLite, 特别是在智能手机应用中. 

在这种架构中, 客户端同时负责以下的所有服务:

- Presentation服务: 负责展示表单和数据输入输出的用户界面
- Application服务: 实现用户请求并与DBMS进行交互
- DBMS: 处理数据库操作请求, 如查询, 插入, 更新和删除

### 双层架构

双层架构, 或称客户端-服务端模型. 在这种架构中, 客户端负责Presentation服务和Application服务, 而服务端负责处理来自客户端的请求, 即有一个DBMS服务. 客户端通过网络向数据库服务器发送查询或者更新请求, 数据库服务器处理请求后返回结果. 通常用于小型或者中等规模的应用程序, 尤其是数据库直接访问的场景. 

### 三层架构

三层架构加了一层中间层, 将应用逻辑即Application服务与用户界面即Presentation服务和数据库管理即DBMS分离. 客户端专注于用户界面和数据展示, 减少客户端的业务逻辑处理量. 中间层负责业务逻辑和处理复杂的应用操作, 它接受来自客户端的请求, 经过逻辑处理, 与数据库管理层通信, 返回结果. 数据库管理层, 即数据库服务器, 负责数据的存储和查询的执行. 这种架构适合大型应用和分布式系统, 层和层之间的通信都是通过网络进行的. 

## 应用开发

### 宿主语言调用SQL

编程语言如C++, Java, PHP, Python都可以在编程语言中调用SQL命令, 并且可以直接引用宿主语言中的变量. 但是在调用之前, 必须确保数据库的连接. 

在宿主语言中调用SQL主要有两种方法: 

- Statement-level Interface (SLI): SQL语句被嵌入到宿主语言中
- Call-level Interface (CLI): 通过调用库的API来间接调用SQL, 典型的例子有JDBC, SQL语句作为字符串传递给JDBC的API函数, 然后JDBC帮你调用. 这种方法的好处是提供了一层抽象的接口, 我们不需要关系底层的数据库是什么类型, 无论是PostgreSQL, 还是MySQL, 只要用一个JDBC的API函数去调用, 效果都是一样的

### JDBC

JDBC是一个Java的API, 用于与支持SQL的数据库系统进行通信, 它支持多种用于查询和更新数据以及检索查询结果的功能. 通过JDBC和数据库交互的过程可以总结为:

1. 获取连接: 首先, 需要连接到数据库. 这通常涉及创建数据库连接对象, 通过提供数据库的URL, 用户名和密码, 连接到数据库服务器
2. 创建`Statement`对象: 一旦连接成功, 需要创建一个`Statement`对象, 这是发送SQL查询到数据库的对象
3. 使用`Statement`对象发送SQL查询并从数据库获取查询结果
4. 使用异常机制处理错误

#### 架构

JDBC是与数据库管理系统无关的, JDBC是编程语言与DBMS之间的一个抽象层. 这意味着无论你使用哪种数据库, 都已通过相同的API来进行操作. 以下是一个SQL请求通过JDBC的执行过程.

1. 应用程序通过JDBC的API发送请求, SQL语句会作为一个参数传递给JDBC的接口
2. 驱动管理器会根据连接中数据库的类型, 选择正确的驱动
3. 驱动将通用的API调用转换为具体的数据库操作, 每种数据库都有自己的驱动程序
4. 数据库操作被发送到相应的数据库, 执行并返回结果

---

